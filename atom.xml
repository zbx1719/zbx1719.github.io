<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zbx1719.github.io</id>
    <title>æ‚è®°</title>
    <updated>2019-05-26T07:32:18.200Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zbx1719.github.io"/>
    <link rel="self" href="https://zbx1719.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://zbx1719.github.io/images/avatar.png</logo>
    <icon>https://zbx1719.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, æ‚è®°</rights>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://zbx1719.github.io/post/hello-gridea</id>
        <link href="https://zbx1719.github.io/post/hello-gridea">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="http://hvenotes.fehey.com/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>ğ–¶ğ—‚ğ—‡ğ–½ğ—ˆğ—ğ—Œ</strong> æˆ– <strong>ğ–¬ğ–ºğ–¼ğ–®ğ–²</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Debeziuméƒ¨ç½²(PostgreSQL)]]></title>
        <id>https://zbx1719.github.io/post/debezium-bu-shu-postgresql</id>
        <link href="https://zbx1719.github.io/post/debezium-bu-shu-postgresql">
        </link>
        <updated>2018-06-05T00:56:23.000Z</updated>
        <summary type="html"><![CDATA[<p>debeziumæ˜¯ä¸€ä¸ªç”¨äºæŠ“å–æ•°æ®åº“å˜æ›´äº‹ä»¶çš„å¼€æºé¡¹ç›®,å®ƒå¯ä»¥å°†æ•°æ®å®æ—¶çš„ä»æ•°æ®åº“ä¸­æŠ½å–å‡ºæ¥å¹¶é€šè¿‡kafka connectæ¨é€åˆ°kafkaä¸­.æ¯ä¸€ä¸ªéƒ¨ç½²åˆ° Kafkaçš„è¿æ¥å™¨éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¸»é¢˜( æ¯ä¸ªæ•°æ®åº“è¡¨é€šå¸¸æœ‰ä¸€ä¸ªä¸»é¢˜) æ•è·æ‰€æœ‰çš„å˜æ›´å¹¶è®°å½•åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚ Kafka ç¡®ä¿æ‰€æœ‰è¿™äº›æ•°æ®æ›´æ”¹äº‹ä»¶è¢«å¤åˆ¶å’Œå®Œå…¨æœ‰åºï¼Œå¹¶ä¸”å…è®¸è®¸å¤šå®¢æˆ·ç«¯ç‹¬ç«‹ä½¿ç”¨è¿™äº›ç›¸åŒçš„æ•°æ®</p>
]]></summary>
        <content type="html"><![CDATA[<p>debeziumæ˜¯ä¸€ä¸ªç”¨äºæŠ“å–æ•°æ®åº“å˜æ›´äº‹ä»¶çš„å¼€æºé¡¹ç›®,å®ƒå¯ä»¥å°†æ•°æ®å®æ—¶çš„ä»æ•°æ®åº“ä¸­æŠ½å–å‡ºæ¥å¹¶é€šè¿‡kafka connectæ¨é€åˆ°kafkaä¸­.æ¯ä¸€ä¸ªéƒ¨ç½²åˆ° Kafkaçš„è¿æ¥å™¨éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¸»é¢˜( æ¯ä¸ªæ•°æ®åº“è¡¨é€šå¸¸æœ‰ä¸€ä¸ªä¸»é¢˜) æ•è·æ‰€æœ‰çš„å˜æ›´å¹¶è®°å½•åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚ Kafka ç¡®ä¿æ‰€æœ‰è¿™äº›æ•°æ®æ›´æ”¹äº‹ä»¶è¢«å¤åˆ¶å’Œå®Œå…¨æœ‰åºï¼Œå¹¶ä¸”å…è®¸è®¸å¤šå®¢æˆ·ç«¯ç‹¬ç«‹ä½¿ç”¨è¿™äº›ç›¸åŒçš„æ•°æ®</p>
<!-- more -->
<h2 id="å‡†å¤‡">å‡†å¤‡</h2>
<p>éƒ¨ç½²debeziumæœ‰å‡ ç‚¹è¦æ±‚:</p>
<ul>
<li>PostgreSQLç‰ˆæœ¬9.4+</li>
<li>kafkaç‰ˆæœ¬0.9.0+</li>
</ul>
<p>PostgreSQLç‰ˆæœ¬éœ€è¦å‡çº§åˆ°9.4ä»¥ä¸Šæ˜¯å› ä¸ºä»9.4ç‰ˆæœ¬å¼€å§‹,PostgreSQLå¼•å…¥äº†logical decodingÂ åŠŸèƒ½,å®ƒå…è®¸ç¬¬ä¸‰æ–¹é€»è¾‘è§£ç æ’ä»¶å°†å®ƒçš„äº‹åŠ¡æ—¥å¿—è¾“å‡º.
kafka åœ¨0.9.0ç‰ˆæœ¬åæ”¯æŒkafka connect,debeziumæœ¬è´¨ä¸Šæ˜¯kafka connectæ’ä»¶,å› æ­¤éœ€è¦æœ‰kafka connectçš„æ”¯æŒ.</p>
<h2 id="æ•°æ®åº“é…ç½®">æ•°æ®åº“é…ç½®</h2>
<p>åœ¨éƒ¨ç½²debeziumå‰éœ€è¦å¯¹PostgreSQLè¿›è¡Œé…ç½®.æˆ‘ä½¿ç”¨çš„æ˜¯9.4ç‰ˆæœ¬çš„åº“.debeziumæ”¯æŒä¸¤ä¸ªé€»è¾‘è§£ç æ’ä»¶
<a href="https://github.com/debezium/postgres-decoderbufs">Protobuf based</a>å’Œ<a href="https://github.com/eulerto/wal2json">wal2json</a>.å› ä¸ºProtobuf basedè¦æ±‚æ•°æ®åº“ç‰ˆæœ¬åœ¨9.6ä»¥ä¸Š,å› æ­¤æˆ‘é‡‡ç”¨äº†wal2jsoné…ç½®.</p>
<h3 id="ç¼–è¯‘å®‰è£…">ç¼–è¯‘å®‰è£…</h3>
<pre><code># é€šè¿‡ä»githubä¸Šä¸‹è½½æ’ä»¶æºç 
$ git clone https://github.com/eulerto/wal2json.git
# ç¼–è¯‘å®‰è£…æ’ä»¶
$ PATH=/path/to/bin/pg_config:$PATH
$ USE_PGXS=1 make
$ USE_PGXS=1 make install
</code></pre>
<h3 id="ä¿®æ”¹é…ç½®">ä¿®æ”¹é…ç½®</h3>
<h4 id="postgresqlconf">postgresql.conf</h4>
<p>éœ€è¦ä¿®æ”¹ä»¥ä¸‹é…ç½®</p>
<pre><code>listen_addresses = '*'  
wal_level = logical
max_replication_slots = 1
max_wal_senders = 1
# MODULES
shared_preload_libraries = 'wal2json'
</code></pre>
<p>max_replication_slots,max_wal_sendersä¸¤é¡¹é…ç½®å¯ä»¥æ ¹æ®éœ€æ±‚æ¥è°ƒå¤§.é…ç½®ä¿®æ”¹åéœ€è¦é‡å¯æ•°æ®åº“ä½¿é…ç½®ç”Ÿæ•ˆ</p>
<h3 id="pg_hbaconf">pg_hba.conf</h3>
<pre><code># TYPE  DATABASE        USER            ADDRESS                 METHOD
host    all             all             0.0.0.0/0               md5
# &quot;local&quot; is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 ident
# Allow replication connections from localhost, by a user with the
# replication privilege.
local   replication     postgres                                trust
host    replication     postgres        127.0.0.1/32            trust
host    replication     postgres        ::1/128                 trust

#wal2json
local    replication     all                     trust
</code></pre>
<p>ä¿®æ”¹åé‡å¯æ•°æ®åº“ç”Ÿæ•ˆ</p>
<h2 id="debeziuméƒ¨ç½²">debeziuméƒ¨ç½²</h2>
<ol>
<li>
<p>ä¸‹è½½<a href="https://www.confluent.io/download/">confluent</a>,è§£å‹åˆ°ä»»æ„ç›®å½•ä¸‹.</p>
</li>
<li>
<p>ä¸‹è½½<a href="https://repo1.maven.org/maven2/io/debezium/debezium-connector-postgres/0.7.5/debezium-connector-postgres-0.7.5-plugin.tar.gz">Postgres Connector plugin archive</a>,è§£å‹åæ”¾åˆ°confluentç›®å½•çš„ share/java/ è·¯å¾„ä¸‹.è§£å‹åçš„åŒ…åä¸ºdebezium-connector-postgres</p>
</li>
<li>
<p>åˆ›å»ºdebeziumé…ç½®æ–‡ä»¶debezium.properties:</p>
<pre><code> name=events-debezium
 tasks.max=1
 connector.class=io.debezium.connector.postgresql.PostgresConnector
 database.hostname=localhost
 database.port=5432
 database.user=postgres
 database.password=postgres
 database.dbname=postgres
 database.history.kafka.bootstrap.servers=localhost:9092
 database.server.id=1
 database.server.name=postgres.localhost
 plugin.name=wal2json
 include.schema.changes=true
</code></pre>
</li>
<li>
<p>è¿›å…¥confluentç›®å½•ä¸‹,å¯åŠ¨zookeeper:</p>
<pre><code> sudo bin/zookeeper-server-start -daemon etc/kafka/zookeeper.properties
</code></pre>
</li>
<li>
<p>å¯åŠ¨kafka:</p>
<pre><code> sudo bin/kafka-server-start -daemon etc/kafka/server.properties
</code></pre>
</li>
<li>
<p>å¯åŠ¨kafka connect:</p>
<pre><code> sudo bin/connect-standalone etc/kafka/connect-standalone.properties etc/kafka-connect-postgres/debezium.properties
</code></pre>
</li>
<li>
<p>kafka connectå¯åŠ¨åä¼šä¸ºæ¯ä¸€å¼ è¡¨å»ºç«‹ä¸€ä¸ªtopic,é€šè¿‡kafka consumerå‘½ä»¤ç›‘å¬æŸä¸€ä¸ªtopic,ç„¶åè¿›è¡Œupdateæ“ä½œ,å¯ä»¥çœ‹åˆ°:</p>
<pre><code> {&quot;schema&quot;:{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;a&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;b&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.time.NanoTimestamp&quot;,&quot;version&quot;:1,&quot;field&quot;:&quot;c&quot;}],&quot;optional&quot;:true,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Value&quot;,&quot;field&quot;:&quot;before&quot;},{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;a&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;b&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.time.NanoTimestamp&quot;,&quot;version&quot;:1,&quot;field&quot;:&quot;c&quot;}],&quot;optional&quot;:true,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Value&quot;,&quot;field&quot;:&quot;after&quot;},{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;version&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;name&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;ts_usec&quot;},{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;txId&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;lsn&quot;},{&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:true,&quot;default&quot;:false,&quot;field&quot;:&quot;snapshot&quot;},{&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;last_snapshot_record&quot;}],&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.connector.postgresql.Source&quot;,&quot;field&quot;:&quot;source&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;op&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;ts_ms&quot;}],&quot;optional&quot;:false,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Envelope&quot;},&quot;payload&quot;:{&quot;before&quot;:{&quot;a&quot;:6,&quot;b&quot;:null,&quot;c&quot;:1526983438558366000},&quot;after&quot;:null,&quot;source&quot;:{&quot;version&quot;:&quot;0.7.5&quot;,&quot;name&quot;:&quot;postgres.localhost&quot;,&quot;ts_usec&quot;:1528103530924231000,&quot;txId&quot;:1927,&quot;lsn&quot;:24850324,&quot;snapshot&quot;:false,&quot;last_snapshot_record&quot;:null},&quot;op&quot;:&quot;d&quot;,&quot;ts_ms&quot;:1528103530926}}
 {&quot;schema&quot;:null,&quot;payload&quot;:null}
 {&quot;schema&quot;:{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;a&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;b&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.time.NanoTimestamp&quot;,&quot;version&quot;:1,&quot;field&quot;:&quot;c&quot;}],&quot;optional&quot;:true,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Value&quot;,&quot;field&quot;:&quot;before&quot;},{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;a&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;b&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.time.NanoTimestamp&quot;,&quot;version&quot;:1,&quot;field&quot;:&quot;c&quot;}],&quot;optional&quot;:true,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Value&quot;,&quot;field&quot;:&quot;after&quot;},{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;version&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;name&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;ts_usec&quot;},{&quot;type&quot;:&quot;int32&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;txId&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;lsn&quot;},{&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:true,&quot;default&quot;:false,&quot;field&quot;:&quot;snapshot&quot;},{&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;last_snapshot_record&quot;}],&quot;optional&quot;:false,&quot;name&quot;:&quot;io.debezium.connector.postgresql.Source&quot;,&quot;field&quot;:&quot;source&quot;},{&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;field&quot;:&quot;op&quot;},{&quot;type&quot;:&quot;int64&quot;,&quot;optional&quot;:true,&quot;field&quot;:&quot;ts_ms&quot;}],&quot;optional&quot;:false,&quot;name&quot;:&quot;postgres.localhost.public.table_with_pk.Envelope&quot;},&quot;payload&quot;:{&quot;before&quot;:null,&quot;after&quot;:{&quot;a&quot;:7,&quot;b&quot;:&quot;Replication&quot;,&quot;c&quot;:1526983438558366000},&quot;source&quot;:{&quot;version&quot;:&quot;0.7.5&quot;,&quot;name&quot;:&quot;postgres.localhost&quot;,&quot;ts_usec&quot;:1528103530924231000,&quot;txId&quot;:1927,&quot;lsn&quot;:24850324,&quot;snapshot&quot;:false,&quot;last_snapshot_record&quot;:null},&quot;op&quot;:&quot;c&quot;,&quot;ts_ms&quot;:1528103530926}}
</code></pre>
</li>
</ol>
<p>ç¬¬ä¸€ä¸ªjsonæ˜¯updateå‰çš„,å…¶ä¸­payloadæ˜¯updateå‰çš„å€¼.</p>
<pre><code>{&quot;before&quot;:{&quot;a&quot;:6,&quot;b&quot;:null,&quot;c&quot;:1526983438558366000},&quot;after&quot;:null,&quot;source&quot;:{&quot;version&quot;:&quot;0.7.5&quot;,&quot;name&quot;:&quot;postgres.localhost&quot;,&quot;ts_usec&quot;:1528103530924231000,&quot;txId&quot;:1927,&quot;lsn&quot;:24850324,&quot;snapshot&quot;:false,&quot;last_snapshot_record&quot;:null},&quot;op&quot;:&quot;d&quot;,&quot;ts_ms&quot;:1528103530926}
</code></pre>
<p>æœ€åä¸€ä¸ªjsonæ˜¯updateåçš„,payloadä¸­æ˜¯updateåçš„å€¼.</p>
<pre><code>{&quot;before&quot;:null,&quot;after&quot;:{&quot;a&quot;:7,&quot;b&quot;:&quot;Replication&quot;,&quot;c&quot;:1526983438558366000},&quot;source&quot;:{&quot;version&quot;:&quot;0.7.5&quot;,&quot;name&quot;:&quot;postgres.localhost&quot;,&quot;ts_usec&quot;:1528103530924231000,&quot;txId&quot;:1927,&quot;lsn&quot;:24850324,&quot;snapshot&quot;:false,&quot;last_snapshot_record&quot;:null},&quot;op&quot;:&quot;c&quot;,&quot;ts_ms&quot;:1528103530926}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ ehcacheæŒä¹…åŒ–åˆ°ç¡¬ç›˜indexä¸¢å¤±é—®é¢˜]]></title>
        <id>https://zbx1719.github.io/post/ehcache-chi-jiu-hua-dao-ying-pan-index-diu-shi-wen-ti</id>
        <link href="https://zbx1719.github.io/post/ehcache-chi-jiu-hua-dao-ying-pan-index-diu-shi-wen-ti">
        </link>
        <updated>2018-03-05T23:00:31.000Z</updated>
        <summary type="html"><![CDATA[<p>ehcacheæŒä¹…åŒ–åˆ°ç¡¬ç›˜åä¼šå‡ºç°ä»¥.indexç»“å°¾çš„ç´¢å¼•æ–‡ä»¶å’Œä»¥.dataç»“å°¾çš„æ•°æ®æ–‡ä»¶.å½“ehcacheé‡å¯æ—¶ä¼šä»ç¡¬ç›˜ä¸­åŠ è½½æ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­.</p>
]]></summary>
        <content type="html"><![CDATA[<p>ehcacheæŒä¹…åŒ–åˆ°ç¡¬ç›˜åä¼šå‡ºç°ä»¥.indexç»“å°¾çš„ç´¢å¼•æ–‡ä»¶å’Œä»¥.dataç»“å°¾çš„æ•°æ®æ–‡ä»¶.å½“ehcacheé‡å¯æ—¶ä¼šä»ç¡¬ç›˜ä¸­åŠ è½½æ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­.</p>
<!-- more -->
<h1 id="é—®é¢˜">é—®é¢˜</h1>
<p>å½“ehcacheé…ç½®å¥½åå‘ehcacheä¸­æ’å…¥æ•°æ®,æ­£å¸¸åœæ­¢ehcacheæ—¶æœ¬åœ°å¯ä»¥çœ‹åˆ°å·²ç»æŒä¹…åŒ–åˆ°æœ¬åœ°çš„æ–‡ä»¶</p>
<pre><code>total 16
-rw-r--r--  1 zhubingxu  staff   2.1K  3  6 14:57 %0043itycode_%00561.data
-rw-r--r--  1 zhubingxu  staff   273B  3  6 14:57 %0043itycode_%00561.index
</code></pre>
<p>è¿™æ—¶å€™æŒä¹…åŒ–æ•°æ®æ˜¯æ­£å¸¸çš„.ç„¶è€Œå½“æœåŠ¡åœæ­¢åæˆ‘ä»¬é€šè¿‡è‡ªå·±å°è£…çš„æ¥å£ç›´æ¥æŸ¥è¯¢EhCacheä¸­çš„æ•°æ®æ—¶ä¼šå‘ç°ç¬¬ä¸€æ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœæ˜¯æ­£å¸¸çš„,ç¬¬äºŒæ¬¡æŸ¥è¯¢å‘ç°è¿”å›çš„ç»“æœä¸ºnull.</p>
<pre><code>ç¬¬ä¸€æ¬¡è°ƒç”¨ç»“æœ
1520317305023

ç¬¬äºŒæ¬¡è°ƒç”¨ç»“æœ
null
</code></pre>
<p>æŸ¥çœ‹æŒä¹…åŒ–æ–‡ä»¶å‘ç°.dataæ–‡ä»¶è¿˜å­˜åœ¨è€Œ.indexç´¢å¼•æ–‡ä»¶ä¸¢å¤±äº†.</p>
<h1 id="åŸå› ">åŸå› </h1>
<p>ehcacheæ¢å¤æ•°æ®æ˜¯æ ¹æ®.indexç´¢å¼•æ–‡ä»¶æ¥è¿›è¡Œæ•°æ®æ¢å¤çš„.å½“ç¨‹åºè¿è¡Œå,ehcacheçš„ä¸€ä¸ªæ–¹æ³•ä¼šå°†.dataæ–‡ä»¶å’Œ.indexæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´è¿›è¡Œæ¯”è¾ƒ,å¦‚æœä¸ç¬¦åˆç›´æ¥å°†.indexæ–‡ä»¶åˆ é™¤.ç¬¬ä¸€æ¬¡è°ƒç”¨å.indexæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸ä¼šå˜,è€Œ.dataçš„ä¿®æ”¹æ—¶é—´ä¼šå˜æˆå½“å‰æ—¶é—´.æ‰€ä»¥ç¬¬äºŒæ¬¡æŸ¥è¯¢æ—¶ç”±äºä¿®æ”¹æ—¶é—´çš„å˜åŒ–å¯¼è‡´.indexæ–‡ä»¶è¢«åˆ é™¤æ— æ³•åŠ è½½ä¹‹å‰ç¼“å­˜ä¸­çš„æ•°æ®,è¿”å›null.</p>
<pre><code>ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶çš„ç»“æœ
å¯ä»¥å‘ç°.dataæ–‡ä»¶æ—¶é—´æ›´æ–°äº†
total 16
-rw-r--r--  1 zhubingxu  staff   2.1K  3  6 15:38 %0043itycode_%00561.data
-rw-r--r--  1 zhubingxu  staff   273B  3  6 14:57 %0043itycode_%00561.index
</code></pre>
<p>è€Œehcacheçš„.indexæ–‡ä»¶å’Œ.dataæ–‡ä»¶æ—¶é—´ä¸ä¸€è‡´çš„åŸå› æ˜¯ehcacheæ˜¯åœ¨åœæ­¢çš„æ—¶å€™é€šè¿‡è§¦å‘ä¸€ä¸ªäº‹ä»¶æ¥ç”Ÿæˆ.indexæ–‡ä»¶çš„,è€Œæˆ‘ä»¬éæ­£å¸¸åœæ­¢æ˜¯ä¸ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶çš„,è¿™å°±å¯¼è‡´.dataæ—¶é—´æ›´æ–°äº†è€Œ.indexæ—¶é—´ä¸å˜.</p>
<h1 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h1>
<p>å› ä¸ºéæ­£å¸¸å…³é—­æ˜¯ä¸ä¼šè§¦å‘å†™å…¥.indexæ–‡ä»¶è¿™ä¸ªæ–¹æ³•,å› æ­¤æˆ‘ä»¬å°±è¦æ‰‹åŠ¨æ¥æ‰§è¡Œè¿™ä¸ªæ–¹æ³•.
é¦–å…ˆåœ¨staticä¸­åŠ å…¥è¿™è¡Œä»£ç </p>
<pre><code>System.setProperty(net.sf.ehcache.CacheManager.ENABLE_SHUTDOWN_HOOK_PROPERTY,&quot;true&quot;);
</code></pre>
<p>å¦‚ä¸‹æ‰€ç¤º</p>
<pre><code>static {
try {
    InputStream inputStream = EhCacheWrap.class.getResourceAsStream(&quot;/databuscache.xml&quot;);
    System.setProperty(net.sf.ehcache.CacheManager.ENABLE_SHUTDOWN_HOOK_PROPERTY,&quot;true&quot;);
    manager = new CacheManager(inputStream);
    if (manager == null) {
        manager = CacheManager.create();
    }
} catch (CacheException var1) {
    var1.printStackTrace();
    System.out.println(&quot;ï¼ï¼ï¼Initialize cache manager failed.&quot; + var1);
    logger.fatal(&quot;ï¼ï¼ï¼Initialize cache manager failed.&quot;, var1);
}
</code></pre>
<p>}</p>
<p>ç„¶ååœ¨æ¯æ¬¡getCache()åéƒ½è¦è°ƒç”¨flush()æ–¹æ³•å®æ—¶å†™å…¥ç¡¬ç›˜.</p>
<pre><code>Cache cache=manager.getCache(arg0);
cache.flush();
</code></pre>
<p>ä¹‹åå†æµ‹è¯•å°±ä¼šå‘ç°è¯»å–ç¼“å­˜æ­£å¸¸äº†,ä¸ä¼šå‡ºç°ç¼“å­˜ä¸¢å¤±çš„æƒ…å†µ</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Databuséƒ¨ç½²(Oracle)]]></title>
        <id>https://zbx1719.github.io/post/databus-bu-shu-oracle</id>
        <link href="https://zbx1719.github.io/post/databus-bu-shu-oracle">
        </link>
        <updated>2018-01-12T00:48:33.000Z</updated>
        <summary type="html"><![CDATA[<p>databusæ”¯æŒä¸¤ç§æ•°æ®åº“:mysqlå’Œoracle.mysqlé‡‡ç”¨çš„æ˜¯bin-logæ–¹å¼,è¿™ç§æ–¹å¼é…ç½®èµ·æ¥ç®€å•.è¿˜æœ‰ä¸€ç§æ˜¯oracle.oracleç”±äºæ²¡æœ‰bin-logæœºåˆ¶,å› æ­¤é‡‡ç”¨å¦å¤–çš„ä¸€ç§æ–¹å¼</p>
]]></summary>
        <content type="html"><![CDATA[<p>databusæ”¯æŒä¸¤ç§æ•°æ®åº“:mysqlå’Œoracle.mysqlé‡‡ç”¨çš„æ˜¯bin-logæ–¹å¼,è¿™ç§æ–¹å¼é…ç½®èµ·æ¥ç®€å•.è¿˜æœ‰ä¸€ç§æ˜¯oracle.oracleç”±äºæ²¡æœ‰bin-logæœºåˆ¶,å› æ­¤é‡‡ç”¨å¦å¤–çš„ä¸€ç§æ–¹å¼</p>
<!-- more -->
<h1 id="databusç›‘æ§oracleåŸç†">databusç›‘æ§oracleåŸç†</h1>
<ul>
<li>æ¯ä¸ªæºè¡¨æ·»åŠ ä¸€ä¸ª txn åˆ—ã€‚æºè¡¨fooæœ€åˆæœ‰ä¸‰åˆ—(A,B,C)ï¼Œä¸ºäº†databusåŒ–éœ€è¦åœ¨æºè¡¨ä¸Šæ·»åŠ ä¸€ä¸ªtxnåˆ—ã€‚è¿™ä¸ªåˆ—è¦å»ºç«‹ç´¢å¼•ï¼Œå¦åˆ™å½±å“æŠ“å–æ•ˆç‡ã€‚</li>
<li>ä¸ºæ¯ä¸ªæ•°æ®åº“éƒ½åˆ›å»ºä¸€ä¸ªsy$txlogè¡¨ã€‚å®ƒè·Ÿè¸ªæ•°æ®åº“ä¸­databusåŒ–çš„æºè¡¨çš„äº‹åŠ¡å˜æ›´ã€‚å®ƒä¸»è¦çš„åˆ—æœ‰(scn, txn, mask, timestamp)ã€‚</li>
<li>æ¯ä¸ªæºè¡¨ä¸Šæœ‰ä¸€ä¸ªinsert/updateçš„å‰ç½®è§¦å‘å™¨ï¼Œå®ƒåšä¸¤ä»¶äº‹æƒ…ï¼š
<ul>
<li>è°ƒç”¨sync_core.getTxn()å¾—åˆ°å½“å‰çš„äº‹åŠ¡IDå¹¶æ’å…¥åˆ°æºè¡¨çš„txnåˆ—ã€‚</li>
<li>æ–°å¢æˆ–ä¿®æ”¹sy$txlogè¡¨ä¸­å¯¹åº”è®°å½•çš„Txnå¹¶ è®¾ç½®ä¸ºæ–°çš„txnidï¼Œscnåˆå§‹åŒ–ä¸ºæ— ç©·å¤§(99999999),å’Œä¸€ä¸ªæ–°çš„maskã€‚</li>
</ul>
</li>
<li>åœ¨åå°æœ‰ä¸€ä¸ªæ¯Nç§’æ‰§è¡Œä¸€æ¬¡çš„åˆå¹¶job(å½“å‰ä¸º2ç§’)ï¼Œå®ƒå°†sy$txlogè¡¨ä¸­scn=Infinityçš„è®°å½•çš„scnæ›´æ–°ä¸ºora_rowscnã€‚</li>
</ul>
<h1 id="é…ç½®databus">é…ç½®databus</h1>
<p>å…ˆä¸‹è½½æºç </p>
<pre><code>git clone  https://github.com/linkedin/databus/
</code></pre>
<p>å¤åˆ¶ <a href="databus-demo/ojdbc6-11.2.0.2.0.jar">ojdbc.jar</a>åˆ° sandbox-repo/com/oracle/ojdbc6/11.2.0.2.0/ è·¯å¾„ä¸‹</p>
<p>æ‰“å¼€</p>
<pre><code>databus-core/databus-core-container/src/main/java/com/linkedin/databus2/core/container/netty/ServerContainer.java
</code></pre>
<p>åœ¨ initializeContainerJmx() æ–¹æ³•ä¸­åŠ å…¥ä¸‹é¢è¿™å¥</p>
<pre><code>LocateRegistry.createRegistry(_containerStaticConfig.getJmx().getRmiRegistryPort());
</code></pre>
<p>ä¸åŠ çš„è¯ä¼šæŠ¥ Cannot bind to URL rmi://localhost:1099 ServiceUnavailableException</p>
<p>åŠ å®Œåç»“æœå¦‚ä¸‹</p>
<pre><code>protected void initializeContainerJmx()
{

if (_containerStaticConfig.getJmx().isRmiEnabled())
{
try
{
  JMXServiceURL jmxServiceUrl =
      new JMXServiceURL(&quot;service:jmx:rmi://&quot; +
                        _containerStaticConfig.getJmx().getJmxServiceHost() + &quot;:&quot; +
                        _containerStaticConfig.getJmx().getJmxServicePort() +&quot;/jndi/rmi://&quot; +
                        _containerStaticConfig.getJmx().getRmiRegistryHost() + &quot;:&quot; +
                        _containerStaticConfig.getJmx().getRmiRegistryPort() + &quot;/jmxrmi&quot; +
                        _containerStaticConfig.getJmx().getJmxServicePort());

  LocateRegistry.createRegistry(_containerStaticConfig.getJmx().getRmiRegistryPort());
  _jmxConnServer = JMXConnectorServerFactory.newJMXConnectorServer(jmxServiceUrl, null,
                                                                   getMbeanServer());
}
catch (Exception e)
{
  LOG.warn(&quot;Unable to instantiate JMX server&quot;, e);
}
}
}
</code></pre>
<p>é…ç½®è¢«ç›‘æ§è¡¨çš„ä¿¡æ¯:ä¿®æ”¹databus2-example-relay-pkg/conf/sources-person.jsonçš„å†…å®¹,å…¶ä¸­</p>
<pre><code>{
&quot;name&quot;: &quot;person&quot;,
&quot;id&quot;: 1,
&quot;uri&quot;: &quot;jdbc:oracle:thin:dbbus/dbbus@localhost:1521:orcl&quot;,
&quot;slowSourceQueryThreshold&quot;: 2000,
&quot;sources&quot;: [
    {
        &quot;id&quot;: 101,
        &quot;name&quot;: &quot;com.linkedin.events.example.person.Person&quot;,
        &quot;uri&quot;: &quot;dbbus.person&quot;,
        &quot;partitionFunction&quot;: &quot;constant:1&quot;
    }
]
</code></pre>
<p>}</p>
<h2 id="æ‰“åŒ…">æ‰“åŒ…</h2>
<p>åœ¨databusæ ¹ç›®å½•ä¸‹æ‰§è¡Œ</p>
<pre><code>gradle -Dopen_source=true assemble
</code></pre>
<h1 id="é…ç½®oracle">é…ç½®oracle</h1>
<p>databusé‡Œè‡ªå¸¦äº†é…ç½®è„šæœ¬,æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å®ç°å¯¹oracleçš„å¿«é€Ÿé…ç½®
oracleé…ç½®è„šæœ¬ä½äºdatabusæ–‡ä»¶å¤¹ä¸‹çš„ /db/oracle/bin è·¯å¾„
é¦–å…ˆè¦æ‰§è¡Œ createUser.shè„šæœ¬,åœ¨æ‰§è¡Œä¹‹å‰éœ€è¦åšä¸€äº›ä¿®æ”¹:</p>
<pre><code>å°†ä¸‹é¢è¿™è¡Œçš„ system/manager\@${DBNAME} åˆ æ‰
sqlplus system/manager\@${DBNAME} as sysdba &lt;&lt; __EOF__
ä¿®æ”¹åå¦‚ä¸‹
sqlplus / as sysdba &lt;&lt; __EOF__
</code></pre>
<p>ç„¶åä¿®æ”¹ç¬¬57è¡Œ,å› ä¸ºæ²¡æœ‰temp1è¿™ä¸ªtablespace,æ‰€ä»¥åˆ°57è¡Œä¼šæŠ¥é”™,æˆ‘ä»¬è¦å°†temporary tablespace temp1åˆ æ‰.åˆ é™¤åçš„ä»£ç å¦‚ä¸‹:</p>
<pre><code>create user ${USER} identified by ${PASSWD} default tablespace ${TBS_UC} ;
</code></pre>
<p>åœ¨oracleç”¨æˆ·ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç”¨æˆ·dbbus/dbbus,å…¶ä¸­db_pathæ˜¯å­˜æ”¾oracleçš„.dbfæ–‡ä»¶çš„è·¯å¾„:</p>
<pre><code>#createUser.sh db_username db_password db_id db_table_space db_path
sh createUser.sh dbbus dbbus orcl tbs_dbbus /u01/app/oracle/product/11.2.0/dbs/
</code></pre>
<p>è¿è¡Œ createSchema.sh åœ¨oracleä¸­ç”Ÿæˆå¿…è¦çš„ package table seq tigger Procedure ç­‰</p>
<pre><code>#createSchema.sh db_username/db_password@db_id tab_and_view_path
sh createSchema.sh dbbus/dbbus@orcl /home/oracle/databus/databus2-example/database/person
</code></pre>
<p>å¯åŠ¨Relay:
* cd build/databus2-example-relay-pkg/distributions
* tar -zxvf databus2-example-relay-pkg.tar.gzè§£å‹
* æ‰§è¡Œå¯åŠ¨è„šæœ¬ ./bin/start-example-relay.sh person</p>
<p>å¯åŠ¨ Client:
* cd build/databus2-example-client-pkg/distributions
* tar -zxvf databus2-example-client-pkg.tar.gzè§£å‹
* æ‰§è¡Œå¯åŠ¨è„šæœ¬ ./bin/start-example-client.sh person</p>
<p>åœ¨oracleä¸­æ‰§è¡Œinsertè¯­å¥</p>
<pre><code>INSERT INTO person(id,first_name, last_name) VALUES(1,'balaji', 'varadaran');
</code></pre>
<p>è¿”å›ä¸‹é¢ç»“æœè¯æ˜æ­å»ºæˆåŠŸ</p>
<pre><code>2018-01-12 15:35:06,338 +1222808 [callback-1] (INFO) {PersonConsumer} firstName: balaji, lastName: varadaran, birthDate: null, deleted: false
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Databuséƒ¨ç½²(MYSQL)]]></title>
        <id>https://zbx1719.github.io/post/databus-bu-shu-mysql</id>
        <link href="https://zbx1719.github.io/post/databus-bu-shu-mysql">
        </link>
        <updated>2017-12-19T07:23:19.000Z</updated>
        <summary type="html"><![CDATA[<p>Databusæ˜¯ä¸€ä¸ªç”±LinkedInå¼€æºçš„ä½å»¶è¿Ÿã€å¯é çš„ã€æ”¯æŒäº‹åŠ¡çš„ã€ä¿æŒä¸€è‡´æ€§çš„æ•°æ®å˜æ›´æŠ“å–ç³»ç»Ÿã€‚å®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p>
<ul>
<li><strong>æ¥æºç‹¬ç«‹</strong>ï¼šDatabusæ”¯æŒå¤šç§æ•°æ®æ¥æºçš„å˜æ›´æŠ“å–ï¼ŒåŒ…æ‹¬Oracleå’ŒMySQLã€‚</li>
<li><strong>å¯æ‰©å±•ã€é«˜åº¦å¯ç”¨</strong>ï¼šDatabusèƒ½æ‰©å±•åˆ°æ”¯æŒæ•°åƒæ¶ˆè´¹è€…å’Œäº‹åŠ¡æ•°æ®æ¥æºï¼ŒåŒæ—¶ä¿æŒé«˜åº¦å¯ç”¨æ€§ã€‚</li>
<li><strong>äº‹åŠ¡æŒ‰åºæäº¤</strong>ï¼šDatabusèƒ½ä¿æŒæ¥æºæ•°æ®åº“ä¸­çš„äº‹åŠ¡å®Œæ•´æ€§ï¼Œå¹¶æŒ‰ç…§äº‹åŠ¡åˆ†ç»„å’Œæ¥æºçš„æäº¤é¡ºå¯»äº¤ä»˜å˜æ›´äº‹ä»¶ã€‚</li>
<li><strong>ä½å»¶è¿Ÿã€æ”¯æŒå¤šç§è®¢é˜…æœºåˆ¶</strong>ï¼šæ•°æ®æºå˜æ›´å®Œæˆåï¼ŒDatabusèƒ½åœ¨æ¯«ç§’çº§å†…å°†äº‹åŠ¡æäº¤ç»™æ¶ˆè´¹è€…ã€‚åŒæ—¶ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨Databusä¸­çš„æœåŠ¡å™¨ç«¯è¿‡æ»¤åŠŸèƒ½ï¼Œå¯ä»¥åªè·å–è‡ªå·±éœ€è¦çš„ç‰¹å®šæ•°æ®ã€‚</li>
<li><strong>æ— é™å›æº¯</strong>ï¼šå¯¹æ¶ˆè´¹è€…æ”¯æŒæ— é™å›æº¯èƒ½åŠ›ï¼Œä¾‹å¦‚å½“æ¶ˆè´¹è€…éœ€è¦äº§ç”Ÿæ•°æ®çš„å®Œæ•´æ‹·è´æ—¶ï¼Œå®ƒä¸ä¼šå¯¹æ•°æ®åº“äº§ç”Ÿä»»ä½•é¢å¤–è´Ÿæ‹…ã€‚å½“æ¶ˆè´¹è€…çš„æ•°æ®å¤§å¤§è½åäºæ¥æºæ•°æ®åº“æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚</li>
</ul>
]]></summary>
        <content type="html"><![CDATA[<p>Databusæ˜¯ä¸€ä¸ªç”±LinkedInå¼€æºçš„ä½å»¶è¿Ÿã€å¯é çš„ã€æ”¯æŒäº‹åŠ¡çš„ã€ä¿æŒä¸€è‡´æ€§çš„æ•°æ®å˜æ›´æŠ“å–ç³»ç»Ÿã€‚å®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p>
<ul>
<li><strong>æ¥æºç‹¬ç«‹</strong>ï¼šDatabusæ”¯æŒå¤šç§æ•°æ®æ¥æºçš„å˜æ›´æŠ“å–ï¼ŒåŒ…æ‹¬Oracleå’ŒMySQLã€‚</li>
<li><strong>å¯æ‰©å±•ã€é«˜åº¦å¯ç”¨</strong>ï¼šDatabusèƒ½æ‰©å±•åˆ°æ”¯æŒæ•°åƒæ¶ˆè´¹è€…å’Œäº‹åŠ¡æ•°æ®æ¥æºï¼ŒåŒæ—¶ä¿æŒé«˜åº¦å¯ç”¨æ€§ã€‚</li>
<li><strong>äº‹åŠ¡æŒ‰åºæäº¤</strong>ï¼šDatabusèƒ½ä¿æŒæ¥æºæ•°æ®åº“ä¸­çš„äº‹åŠ¡å®Œæ•´æ€§ï¼Œå¹¶æŒ‰ç…§äº‹åŠ¡åˆ†ç»„å’Œæ¥æºçš„æäº¤é¡ºå¯»äº¤ä»˜å˜æ›´äº‹ä»¶ã€‚</li>
<li><strong>ä½å»¶è¿Ÿã€æ”¯æŒå¤šç§è®¢é˜…æœºåˆ¶</strong>ï¼šæ•°æ®æºå˜æ›´å®Œæˆåï¼ŒDatabusèƒ½åœ¨æ¯«ç§’çº§å†…å°†äº‹åŠ¡æäº¤ç»™æ¶ˆè´¹è€…ã€‚åŒæ—¶ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨Databusä¸­çš„æœåŠ¡å™¨ç«¯è¿‡æ»¤åŠŸèƒ½ï¼Œå¯ä»¥åªè·å–è‡ªå·±éœ€è¦çš„ç‰¹å®šæ•°æ®ã€‚</li>
<li><strong>æ— é™å›æº¯</strong>ï¼šå¯¹æ¶ˆè´¹è€…æ”¯æŒæ— é™å›æº¯èƒ½åŠ›ï¼Œä¾‹å¦‚å½“æ¶ˆè´¹è€…éœ€è¦äº§ç”Ÿæ•°æ®çš„å®Œæ•´æ‹·è´æ—¶ï¼Œå®ƒä¸ä¼šå¯¹æ•°æ®åº“äº§ç”Ÿä»»ä½•é¢å¤–è´Ÿæ‹…ã€‚å½“æ¶ˆè´¹è€…çš„æ•°æ®å¤§å¤§è½åäºæ¥æºæ•°æ®åº“æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚</li>
</ul>
<!-- more -->
<h1 id="éƒ¨ç½²">éƒ¨ç½²</h1>
<h2 id="gradleå®‰è£…">gradleå®‰è£…</h2>
<p>Databusé‡‡ç”¨gradleç¼–è¯‘,å› æ­¤åœ¨ç¼–è¯‘å‰éœ€è¦å®‰è£…gradle</p>
<p>macOSå®‰è£…gradleæ–¹æ³•:</p>
<pre><code>brew install gradle
</code></pre>
<p>å®‰è£…å®Œæˆåè¾“å…¥ gradle -version å¦‚æœå‡ºç°ä»¥ä¸‹ä¿¡æ¯åˆ™å®‰è£…æˆåŠŸ</p>
<pre><code>------------------------------------------------------------
Gradle 4.3.1
------------------------------------------------------------

Build time:   2017-11-08 08:59:45 UTC
Revision:     e4f4804807ef7c2829da51877861ff06e07e006d

Groovy:       2.4.12
Ant:          Apache Ant(TM) version 1.9.6 compiled on June 29 2015
JVM:          1.8.0_131 (Oracle Corporation 25.131-b11)
OS:           Mac OS X 10.13.2 x86_64
</code></pre>
<h2 id="æ•°æ®åº“é…ç½®">æ•°æ®åº“é…ç½®</h2>
<p>å®‰è£…mysqlæ•°æ®åº“.æˆ‘ä½¿ç”¨çš„æ˜¯5.5.56ç‰ˆæœ¬.é«˜ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰é—®é¢˜.
æ•°æ®åº“è¦å¼€å¯binlog,æŸ¥çœ‹æ˜¯å¦å¼€å¯çš„æ–¹æ³•æ˜¯</p>
<pre><code>  SHOW VARIABLES LIKE 'log_bin';
</code></pre>
<p>å¦‚æœæ²¡æœ‰å¼€å¯å¯ä»¥ç”¨</p>
<pre><code>SET SQL_LOG_BIN=1;
</code></pre>
<p>æ¥å¼€å¯.</p>
<p>å°†æ•°æ®åº“binlog_formatè®¾ç½®æˆROW.æŸ¥çœ‹binlog_formatæ–¹æ³•ä¸º</p>
<pre><code>SHOW VARIABLES LIKE 'binlog_format';
</code></pre>
<p>è®¾ç½®æ–¹æ³•ä¸º</p>
<pre><code>SET GLOBLE binlog_format =ROW;
</code></pre>
<p>å°† binlog_checksum è®¾ç½®ä¸ºç©º.æŸ¥çœ‹æ–¹æ³•ä¸º</p>
<pre><code>SHOW GLOBAL VARIABLES LIKE 'binlog_checksum';
</code></pre>
<p>è®¾ç½®æ–¹æ³•ä¸º</p>
<pre><code>SET binlog_checksum=NONE;
</code></pre>
<p>åœ¨mysqlä¸Šåˆ›å»ºåä¸ºor_testçš„æ•°æ®åº“</p>
<pre><code>CREATE DATABASE or_test;
</code></pre>
<p>å¹¶åœ¨or_testä¸Šåˆ›å»ºåä¸ºpersonçš„è¡¨:</p>
<pre><code>CREATE TABLE person
(
id INT(11) PRIMARY KEY NOT NULL,
first_name VARCHAR(120) NOT NULL,
last_name VARCHAR(120) NOT NULL,
birth_date DATE,
deleted VARCHAR(5) NOT NULL
);
</code></pre>
<h2 id="æºç é…ç½®">æºç é…ç½®</h2>
<p>å…ˆä¸‹è½½æºç </p>
<pre><code>git clone  https://github.com/linkedin/databus/
</code></pre>
<p>å¤åˆ¶ <a href="databus-demo/ojdbc6-11.2.0.2.0.jar">ojdbc.jar</a>åˆ° sandbox-repo/com/oracle/ojdbc6/11.2.0.2.0/ è·¯å¾„ä¸‹</p>
<p>æ‰“å¼€</p>
<pre><code>databus-core/databus-core-container/src/main/java/com/linkedin/databus2/core/container/netty/ServerContainer.java
</code></pre>
<p>åœ¨ initializeContainerJmx() æ–¹æ³•ä¸­åŠ å…¥ä¸‹é¢è¿™å¥</p>
<pre><code>LocateRegistry.createRegistry(_containerStaticConfig.getJmx().getRmiRegistryPort());
</code></pre>
<p>ä¸åŠ çš„è¯ä¼šæŠ¥ Cannot bind to URL rmi://localhost:1099 ServiceUnavailableException</p>
<p>åŠ å®Œåç»“æœå¦‚ä¸‹</p>
<pre><code>protected void initializeContainerJmx()
{

if (_containerStaticConfig.getJmx().isRmiEnabled())
{
try
{
  JMXServiceURL jmxServiceUrl =
      new JMXServiceURL(&quot;service:jmx:rmi://&quot; +
                        _containerStaticConfig.getJmx().getJmxServiceHost() + &quot;:&quot; +
                        _containerStaticConfig.getJmx().getJmxServicePort() +&quot;/jndi/rmi://&quot; +
                        _containerStaticConfig.getJmx().getRmiRegistryHost() + &quot;:&quot; +
                        _containerStaticConfig.getJmx().getRmiRegistryPort() + &quot;/jmxrmi&quot; +
                        _containerStaticConfig.getJmx().getJmxServicePort());

  LocateRegistry.createRegistry(_containerStaticConfig.getJmx().getRmiRegistryPort());
  _jmxConnServer = JMXConnectorServerFactory.newJMXConnectorServer(jmxServiceUrl, null,
                                                                   getMbeanServer());
}
catch (Exception e)
{
  LOG.warn(&quot;Unable to instantiate JMX server&quot;, e);
}
}
}
</code></pre>
<p>é…ç½®è¢«ç›‘æ§è¡¨çš„ä¿¡æ¯:ä¿®æ”¹databus2-example-relay-pkg/conf/sources-or-person.jsonçš„å†…å®¹,å…¶ä¸­
URI</p>
<pre><code>format:mysql://username/password@mysql_host[:mysql_port]/mysql_serverid/binlog_prefix,
</code></pre>
<p>æ³¨æ„%2Fä¸ºè½¬ä¹‰ç¬¦,ç”¨æˆ·åä¸ºroot,å¯†ç ä¸ºroot.å…¶ä¸­uriå¯¹åº”ç€mysqlä¸­çš„åº“åå’Œè¡¨å.</p>
<pre><code>{
&quot;name&quot; : &quot;person&quot;,
&quot;id&quot;  : 1,
&quot;uri&quot; : &quot;mysql://root%2Froot@localhost:3306/1/mysql-bin&quot;,
&quot;slowSourceQueryThreshold&quot; : 2000,
&quot;sources&quot; :
[
    {
    &quot;id&quot; : 40,
    &quot;name&quot; : &quot;com.linkedin.events.example.or_test.Person&quot;,
    &quot;uri&quot;: &quot;or_test.person&quot;,
    &quot;partitionFunction&quot; : &quot;constant:1&quot;
     }
]
}
</code></pre>
<p>databus2-example-relay-pkg/schemas_registry/ä¸‹å®šä¹‰personçš„Avro schemaæ–‡ä»¶com.linkedin.events.example.or_test.Person.1.avscï¼Œå…¶ä¸­1è¡¨ç¤ºç‰ˆæœ¬(Databusç›®å‰æ²¡æœ‰é’ˆå¯¹mysqlæä¾›ç”ŸæˆAvro schemaæ–‡ä»¶çš„å·¥å…·ï¼Œæ‰€ä»¥åªèƒ½æ‰‹å·¥ç¼–å†™)å…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code>{
  &quot;name&quot; : &quot;Person_V1&quot;,
  &quot;doc&quot; : &quot;Auto-generated Avro schema for sy$person. Generated at Dec 04, 2012 05:07:05 PM PST&quot;,
  &quot;type&quot; : &quot;record&quot;,
  &quot;meta&quot; : &quot;dbFieldName=person;pk=id;&quot;,
  &quot;namespace&quot; : &quot;com.linkedin.events.example.or_test&quot;,
  &quot;fields&quot; : [ {
    &quot;name&quot; : &quot;id&quot;,
    &quot;type&quot; : [ &quot;long&quot;, &quot;null&quot; ],
    &quot;meta&quot; : &quot;dbFieldName=ID;dbFieldPosition=0;&quot;
  }, {
    &quot;name&quot; : &quot;firstName&quot;,
    &quot;type&quot; : [ &quot;string&quot;, &quot;null&quot; ],
    &quot;meta&quot; : &quot;dbFieldName=FIRST_NAME;dbFieldPosition=1;&quot;
  }, {
    &quot;name&quot; : &quot;lastName&quot;,
    &quot;type&quot; : [ &quot;string&quot;, &quot;null&quot; ],
    &quot;meta&quot; : &quot;dbFieldName=LAST_NAME;dbFieldPosition=2;&quot;
  }, {
    &quot;name&quot; : &quot;birthDate&quot;,
    &quot;type&quot; : [ &quot;long&quot;, &quot;null&quot; ],
    &quot;meta&quot; : &quot;dbFieldName=BIRTH_DATE;dbFieldPosition=3;&quot;
  }, {
    &quot;name&quot; : &quot;deleted&quot;,
    &quot;type&quot; : [ &quot;string&quot;, &quot;null&quot; ],
    &quot;meta&quot; : &quot;dbFieldName=DELETED;dbFieldPosition=4;&quot;
  } ]
}
</code></pre>
<p>æ³¨å†ŒAvro schemaåˆ°index.schemas_registryæ–‡ä»¶databus2-example-relay-pkg/schemas_registry/index.schemas_registryæ–‡ä»¶ä¸­,
æ·»åŠ è¡Œcom.linkedin.events.example.or_test.Person.1.avsc ï¼Œæ¯å®šä¹‰ä¸€ä¸ªAvro schemaéƒ½éœ€è¦æ·»åŠ è¿›å»ï¼Œrelayè¿è¡Œæ—¶ä¼šåˆ°æ­¤æ–‡ä»¶ä¸­æŸ¥æ‰¾è¡¨å¯¹åº”çš„å®šä¹‰çš„Avro schemaã€‚</p>
<h2 id="éƒ¨ç½²å¯åŠ¨">éƒ¨ç½²å¯åŠ¨</h2>
<p>è¿›å…¥databusæ ¹ç›®å½•æ‰§è¡Œå‘½ä»¤gradle -Dopen_source=true assembleå³å¯å®Œæˆbuild,æˆåŠŸååœ¨databusæ ¹ç›®å½•ä¸‹ç”Ÿæˆåä¸ºbuildçš„æ–‡ä»¶å¤¹</p>
<h3 id="å¯åŠ¨relay">å¯åŠ¨Relay:</h3>
<ul>
<li>cd build/databus2-example-relay-pkg/distributions</li>
<li>tar -zxvf databus2-example-relay-pkg.tar.gzè§£å‹</li>
<li>æ‰§è¡Œå¯åŠ¨è„šæœ¬ ./bin/start-example-relay.sh or_person -Y ./conf/sources-or-person.json</li>
<li>æ‰§è¡Œå‘½ä»¤ curl -s http://localhost:11115/sources è¿”å›å¦‚ä¸‹å†…å®¹è¯´æ˜å¯åŠ¨æˆåŠŸï¼š</li>
</ul>
<h3 id="å¯åŠ¨-client">å¯åŠ¨ Client:</h3>
<ul>
<li>cd build/databus2-example-client-pkg/distributions</li>
<li>tar -zxvf databus2-example-client-pkg.tar.gzè§£å‹</li>
<li>æ‰§è¡Œå¯åŠ¨è„šæœ¬ ./bin/start-example-client.sh person
æ‰§è¡Œå‘½ä»¤ curl http://localhost:11115/relayStats/outbound/http/clients è¿”å›å¦‚ä¸‹å†…å®¹è¯´æ˜å¯åŠ¨æˆåŠŸï¼š</li>
</ul>
<h2 id="æµ‹è¯•">æµ‹è¯•</h2>
<p>Relayå’ŒClientå¯åŠ¨æˆåŠŸåï¼Œå°±å·²ç»å¼€å§‹å¯¹personè¡¨è¿›è¡Œæ•°æ®å˜æ›´æ•è·äº†ï¼Œç°åœ¨å‘personè¡¨æ’å…¥ä¸€æ¡æ•°æ®:</p>
<pre><code>INSERT person VALUES (1,'zhangsan','lisi',20371231235959,0);
</code></pre>
<p>databus2-example-relay-pkg/distributions/logsä¸‹çš„relay.logè®°å½•å¦‚ä¸‹:</p>
<pre><code>2017-12-19 18:44:01,356 +148827 [ORListener_person] (INFO) {OpenReplicator_person} BEGIN sql: BEGIN
2017-12-19 18:44:01,357 +148828 [ORListener_person] (INFO) {OpenReplicator_person} startXtionQueryEvent[header=BinlogEventV4HeaderImpl[timestamp=1513680243000,eventType=2,serverId=1,eventLength=71,nextPosition=596,flags=8,timestampOfReceipt=1513680241355],threadId=1,elapsedTime=0,databaseNameLength=7,errorCode=0,statusVariablesLength=26,statusVariables=[QFlags2Code[flags=0], QSQLModeCode[sqlMode=2097152], QCatalogNzCode[catalogName=std], QCharsetCode[characterSetClient=33,collationConnection=33,collationServer=8]],databaseName=or_test,sql=BEGIN]
2017-12-19 18:44:01,357 +148828 [ORListener_person] (INFO) {DatabusThreadBase} Starting source: or_test.person
2017-12-19 18:44:01,357 +148828 [ORListener_person] (INFO) {DatabusThreadBase} INSERT INTO or_test.person
2017-12-19 18:44:01,359 +148830 [transactionWriter] (INFO) {person} src:com.linkedin.events.example.or_test.Person(40) #src:1 #evt:1 scn:34359739022 ms:-1 sizeInBytes:28 msEvent:1 msTimeElapsed:0 msQueryExec:-1 prodRate:0.00 consRate:-28.00
2017-12-19 18:44:01,363 +148834 [transactionWriter] (INFO) {person} src:person(0) #src:1 #evt:1 scn:34359739022 ms:-1 sizeInBytes:28 msEvent:1 msTimeElapsed:0 msQueryExec:-1 prodRate:0.00 consRate:-28.00
</code></pre>
<p>databus2-example-client-pkg/distributions/logsä¸‹çš„client.logè®°å½•å¦‚ä¸‹ï¼š</p>
<pre><code>2017-12-19 18:44:23,444 +443 [callback-1] (INFO) {PersonConsumer} firstName: zhangsan, lastName: lisi, birthDate: 2145801600000, deleted: 0
</code></pre>
<p>è‡³æ­¤,demoæ­å»ºå®Œæˆ.</p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://github.com/linkedin/databus">databus GitHubåœ°å€</a></li>
<li><a href="http://www.jianshu.com/p/9df54eb1ec35">linkedin çš„ databus éƒ¨ç½²(ç®€ä¹¦)</a></li>
<li><a href="http://tech.lede.com/2017/05/24/rd/server/databus/">Databusæ¶æ„åˆ†æä¸åˆæ­¥å®è·µï¼ˆfor mysqlï¼‰</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åœ¨Ubuntu17ä¸Šå®‰è£…Docker]]></title>
        <id>https://zbx1719.github.io/post/zai-ubuntu17-shang-an-zhuang-docker</id>
        <link href="https://zbx1719.github.io/post/zai-ubuntu17-shang-an-zhuang-docker">
        </link>
        <updated>2017-11-17T12:35:17.000Z</updated>
        <summary type="html"><![CDATA[<p>åœ¨Ubuntu17ä¸Šå®‰è£…Docker</p>
]]></summary>
        <content type="html"><![CDATA[<p>åœ¨Ubuntu17ä¸Šå®‰è£…Docker</p>
<!-- more -->
<h1 id="å‡†å¤‡">å‡†å¤‡</h1>
<ul>
<li>
<p>é¦–å…ˆå®‰è£…Dockeræ‰€éœ€çš„ä¾èµ–</p>
<pre><code>sudo apt-get update
sudo apt-get install apt-transport-https ca-certificates curl software-properties-common
</code></pre>
</li>
</ul>
<h1 id="å®‰è£…">å®‰è£…</h1>
<ul>
<li>
<p>ä¸ºäº†ç¡®è®¤æ‰€ä¸‹è½½è½¯ä»¶åŒ…çš„åˆæ³•æ€§ï¼Œéœ€è¦æ·»åŠ è½¯ä»¶æºçš„ GPG å¯†é’¥ã€‚</p>
<pre><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre>
</li>
<li>
<p>é€šè¿‡æœç´¢æŒ‡çº¹çš„æœ€å8ä¸ªå­—ç¬¦ï¼Œç¡®è®¤æ‚¨ç°åœ¨å·²ç»æ‹¥æœ‰æŒ‡çº¹9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88çš„å¯†é’¥ã€‚</p>
<pre><code>sudo apt-key fingerprint 0EBFCD88
</code></pre>
</li>
<li>
<p>æ·»åŠ dockeræº</p>
<pre><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;
</code></pre>
</li>
<li>
<p>æ›´æ–°apt-getå¹¶å®‰è£…docker</p>
<pre><code>sudo apt-get update
sudo apt-get install docker-ce
</code></pre>
</li>
<li>
<p>å¯åŠ¨docker</p>
<pre><code>sudo service docker start
</code></pre>
</li>
</ul>
<h1 id="é—®é¢˜">é—®é¢˜</h1>
<ul>
<li>
<p>å¦‚æœè¿è¡Œå‘½ä»¤é‡åˆ°é—®é¢˜</p>
<pre><code>dial unix /var/run/docker.sock: permission denied.Are you trying to connect to a TLS-enabled
</code></pre>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>æŠŠå½“å‰ç”¨æˆ·åŠ å…¥dockerç”¨æˆ·ç»„ã€‚</p>
<pre><code>  sudo gpasswd -a ${USER} docker
</code></pre>
<p>æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸï¼š</p>
<pre><code>  cat /etc/group | grep ^docker
</code></pre>
<p>é‡å¯docker</p>
<pre><code>  sudo serivce docker restart
</code></pre>
<p>å¦‚æœé‡å¯åä¸æˆåŠŸï¼Œé€€å‡ºå½“å‰è´¦æˆ·é‡æ–°ç™»å½•ã€‚</p>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[erlangåŠ è½½cryptoæ—¶opensslç¼ºå¤±è§£å†³æ–¹æ¡ˆ]]></title>
        <id>https://zbx1719.github.io/post/erlang-jia-zai-crypto-shi-openssl-que-shi-jie-jue-fang-an</id>
        <link href="https://zbx1719.github.io/post/erlang-jia-zai-crypto-shi-openssl-que-shi-jie-jue-fang-an">
        </link>
        <updated>2017-11-15T11:27:04.000Z</updated>
        <summary type="html"><![CDATA[<p>erlangå®‰è£…å¥½erlangåä½¿ç”¨cryptoæ¨¡å—æ—¶æŠ¥é”™,é”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p>
<pre><code>Unable to load crypto library. Failed with error:
&quot;load_failed, Failed to load NIF library: '/opt/app/mskyprocess/opt/otp183/lib/erlang/lib/crypto-3.7.3/priv/lib/crypto.so: undefined symbol: EC_GROUP_new_curve_GF2m'&quot;
OpenSSL might not be installed on this system.

=WARNING REPORT==== 15-Nov-2017::19:24:03 ===
The on_load function for module crypto returned {error,
 {load_failed,
  &quot;Failed to load NIF library: '/opt/app/mskyprocess/opt/otp183/lib/erlang/lib/crypto-3.7.3/priv/lib/crypto.so: undefined symbol: EC_GROUP_new_curve_GF2m'&quot;}}</code></pre>
]]></summary>
        <content type="html"><![CDATA[<p>erlangå®‰è£…å¥½erlangåä½¿ç”¨cryptoæ¨¡å—æ—¶æŠ¥é”™,é”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p>
<pre><code>Unable to load crypto library. Failed with error:
&quot;load_failed, Failed to load NIF library: '/opt/app/mskyprocess/opt/otp183/lib/erlang/lib/crypto-3.7.3/priv/lib/crypto.so: undefined symbol: EC_GROUP_new_curve_GF2m'&quot;
OpenSSL might not be installed on this system.

=WARNING REPORT==== 15-Nov-2017::19:24:03 ===
The on_load function for module crypto returned {error,
 {load_failed,
  &quot;Failed to load NIF library: '/opt/app/mskyprocess/opt/otp183/lib/erlang/lib/crypto-3.7.3/priv/lib/crypto.so: undefined symbol: EC_GROUP_new_curve_GF2m'&quot;}}
</code></pre>
<!-- more -->
<p>è§£å†³æ–¹æ³•:</p>
<ol>
<li>
<p>ä¸‹è½½opensslæºç 
wget http://www.openssl.org/source/openssl-1.0.1f.tar.gz</p>
<pre><code> tar zxvf openssl-1.0.1f.tar.gz
</code></pre>
</li>
<li>
<p>è¿›å…¥æºç ç›®å½•ï¼Œå¦‚æœä¸æ˜¯æ–°ä¸‹è½½è§£å‹çš„ç›®å½•ï¼Œè€Œä¸”ä»¥å‰æœ‰ç¼–è¯‘å®‰è£…è¿‡çš„ï¼Œè¿›å…¥ç›®å½•åæ‰§è¡Œmake cleanä»¥ç¡®ä¿èƒ½é‡æ–°ç¼–è¯‘
cd openssl-1.0.1f</p>
</li>
<li>
<p>ä¸ºäº†ä¸è¦å’Œå·²å®‰è£…çš„opensslæ··æ·†ï¼Œè¿™é‡ŒæŒ‡å®šä¸€ä¸ªæ–°çš„å®‰è£…ç›®å½•
./config --prefix=/opt/ssl</p>
</li>
<li>
<p>configä¹‹åï¼Œä¼šç”ŸæˆMakefileï¼Œæ‰“å¼€Makefileæ‰¾åˆ°gccï¼Œåœ¨CFLAGå‚æ•°åˆ—è¡¨é‡ŒåŠ ä¸Š-fPIC</p>
</li>
</ol>
<p>vim Makefile</p>
<pre><code>    CC= gcc    
    CFLAG= -fPIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -DTERMIO -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM  
</code></pre>
<ol start="5">
<li>
<p>ç¼–è¯‘å®‰è£…
make &amp;&amp; make install</p>
</li>
<li>
<p>ç°åœ¨è¿›å…¥ä½ çš„erlangæºç å®‰è£…ç›®å½•ï¼Œå¦‚æœå·²ç»ç¼–è¯‘å®‰è£…è¿‡erlangï¼Œä¸ºç¡®ä¿èƒ½é‡æ–°ç¼–è¯‘ï¼Œå…ˆæ‰§è¡Œï¼š
make clean</p>
</li>
<li>
<p>åŠ ä¸Šopensslå®‰è£…è·¯å¾„é‡æ–°configureï¼Œå¦‚æœæœ‰å®‰è£…å¤šä¸ªç‰ˆæœ¬çš„erlangï¼Œä¸ºäº†å¯ä»¥æ–¹ä¾¿æ‰¾åˆ°æ–°å®‰è£…çš„erlï¼Œè¿™é‡Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæ–°çš„å®‰è£…ç›®å½•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š
./configure --with-ssl=/opt/ssl/ --prefix=/opt/erlang</p>
</li>
<li>
<p>ç¼–è¯‘å¹¶å®‰è£…
make &amp;&amp; make install</p>
</li>
<li>
<p>è¿è¡Œåˆšæ‰å®‰è£…çš„erlang</p>
<p>/opt/erlang/bin/erl</p>
<pre><code> Erlang/OTP 19 [erts-8.3] [source] [64-bit] [smp:2:2] [async-threads:10] [hipe] [kernel-poll:false]
 Eshell V8.3  (abort with ^G)
 1&gt; crypto:start().  
 ok
 2&gt;
</code></pre>
</li>
</ol>
<p>å‚è€ƒé“¾æ¥: http://blog.csdn.net/zhongruixian/article/details/21076405</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è§£å†³ç¼–è¯‘å®‰è£…erlangæ—¶ncursesç¼ºå¤±]]></title>
        <id>https://zbx1719.github.io/post/jie-jue-bian-yi-an-zhuang-erlang-shi-ncurses-que-shi</id>
        <link href="https://zbx1719.github.io/post/jie-jue-bian-yi-an-zhuang-erlang-shi-ncurses-que-shi">
        </link>
        <updated>2017-11-14T06:56:59.000Z</updated>
        <summary type="html"><![CDATA[<p>å…¬å¸çš„æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘,å› æ­¤éœ€è¦ä¸‹è½½å¥½è½¯ä»¶åä¼ åˆ°æœåŠ¡å™¨ä¸Šè¿›è¡Œç¼–è¯‘
å®‰è£…erlangæ—¶å‡ºç°äº†å¦‚ä¸‹é—®é¢˜</p>
]]></summary>
        <content type="html"><![CDATA[<p>å…¬å¸çš„æœåŠ¡å™¨æ— æ³•è®¿é—®å¤–ç½‘,å› æ­¤éœ€è¦ä¸‹è½½å¥½è½¯ä»¶åä¼ åˆ°æœåŠ¡å™¨ä¸Šè¿›è¡Œç¼–è¯‘
å®‰è£…erlangæ—¶å‡ºç°äº†å¦‚ä¸‹é—®é¢˜</p>
<!-- more -->
<pre><code>checking for tgetent in -ltinfo... no
checking for tgetent in -lncurses... no
checking for tgetent in -lcurses... no
checking for tgetent in -ltermcap... no
checking for tgetent in -ltermlib... no
configure: error: No curses library functions found
configure: error: /bin/sh '/home/jboss5/umechat/otp_src_19.3/erts/configure' failed for erts
</code></pre>
<p>åŸå› :
ç¼ºå°‘ncurseså®‰è£…åŒ…</p>
<p>å› æ­¤åˆ°<a href="http://ftp.gnu.org/gnu/ncurses/">è¿™é‡Œ</a>ä¸‹è½½ncuroses.
æˆ‘é€‰æ‹©çš„æ˜¯æœ€æ–°ç‰ˆ<a href="http://ftp.gnu.org/gnu/ncurses/ncurses-6.0.tar.gz">ncurses-6.0.tar.gz</a>
æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p>
<pre><code>tar -zxvf ncurses-6.0.tar.gz
cd ncurses-6.0
./configure --with-shared --without-debug --without-ada --enable-overwrite
make
make install
</code></pre>
<p>ncurseså®Œæˆå®‰è£…åå†æ¬¡å®‰è£…erlangå³å¯</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åœ¨Ubuntu Serverä¸‹å®‰è£…Dropbox]]></title>
        <id>https://zbx1719.github.io/post/zai-ubuntu-server-xia-an-zhuang-dropbox</id>
        <link href="https://zbx1719.github.io/post/zai-ubuntu-server-xia-an-zhuang-dropbox">
        </link>
        <updated>2017-10-18T22:00:54.000Z</updated>
        <summary type="html"><![CDATA[<p>æœåŠ¡å™¨å’Œæœ¬åœ°ä¹‹é—´è¦åŒæ­¥ä¸œè¥¿,æ€»æ˜¯ç”¨ftpæŒºçƒ¦çš„.å‘ç°Dropboxæœ‰Linux serverç‰ˆ,åˆšå¥½æœåŠ¡å™¨å¤„äºæµ·å¤–ä¸éœ€è¦ç¿»å¢™,äºæ˜¯å®‰è£…ä¸€ä¸ªç”¨æ¥åŒæ­¥æ–‡ä»¶.</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœåŠ¡å™¨å’Œæœ¬åœ°ä¹‹é—´è¦åŒæ­¥ä¸œè¥¿,æ€»æ˜¯ç”¨ftpæŒºçƒ¦çš„.å‘ç°Dropboxæœ‰Linux serverç‰ˆ,åˆšå¥½æœåŠ¡å™¨å¤„äºæµ·å¤–ä¸éœ€è¦ç¿»å¢™,äºæ˜¯å®‰è£…ä¸€ä¸ªç”¨æ¥åŒæ­¥æ–‡ä»¶.</p>
<!-- more -->
<h2 id="å®‰è£…">å®‰è£…</h2>
<h3 id="å®‰è£…ä¸»ç¨‹åº">å®‰è£…ä¸»ç¨‹åº</h3>
<p>é€šè¿‡å‘½ä»¤è¡Œä¸‹è½½å®‰è£…Dropbox</p>
<pre><code>cd ~ &amp;&amp; wget -O - &quot;https://www.dropbox.com/download?plat=lnx.x86_64&quot; | tar xzf -
</code></pre>
<p>å®‰è£…å®Œæˆåå¯åŠ¨dropbox</p>
<pre><code>~/.dropbox-dist/dropboxd
</code></pre>
<p>å¦‚æœæ˜¯é¦–æ¬¡åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ Dropboxï¼Œç³»ç»Ÿä¼šè¦æ±‚å°†é“¾æ¥å¤åˆ¶å¹¶ç²˜è´´åˆ°è¿è¡Œçš„æµè§ˆå™¨ä¸­ï¼Œä»¥ä¾¿åˆ›å»ºä¸€ä¸ªæ–°çš„å¸æˆ·æˆ–å°†æœåŠ¡å™¨é™„åŠ åˆ°ç°æœ‰å¸æˆ·ä¸Šã€‚æ“ä½œå®Œæˆåï¼Œç³»ç»Ÿä¼šåœ¨ä¸»ç›®å½•ä¸­åˆ›å»º Dropbox æ–‡ä»¶å¤¹ã€‚</p>
<h3 id="ä¸‹è½½æ§åˆ¶è„šæœ¬">ä¸‹è½½æ§åˆ¶è„šæœ¬</h3>
<p>å®‰è£…å®Œæˆåä¸‹è½½è¿™ä¸ª<a href="https://www.dropbox.com/download?dl=packages/dropbox.py">pythonè„šæœ¬</a>ç”¨æ¥æ§åˆ¶Dropbox.</p>
<p>è„šæœ¬å‚æ•°å¦‚ä¸‹:</p>
<pre><code>status       æŸ¥çœ‹DropboxçŠ¶æ€
throttle     è®¾ç½®å¸¦å®½é™åˆ¶
help         æä¾›å¸®åŠ©
puburl       è·å–publicæ–‡ä»¶åˆ†äº«é“¾æ¥
stop         åœæ­¢dropbox
running      è¿”å›dropboxè¿è¡ŒçŠ¶æ€
start        å¯åŠ¨dropbox
filestatus   è·å–æ–‡ä»¶åŒæ­¥çŠ¶æ€
ls           åˆ—å‡ºå½“å‰ç›®å½•åŒæ­¥çŠ¶æ€
autostart    ç™»å½•æ—¶è‡ªåŠ¨å¯åŠ¨dropbox
exclude      ä¸åŒæ­¥çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹
lansync      å¼€å¯/å…³é—­ lan åŒæ­¥
sharelink    åˆ†äº«é“¾æ¥
proxy        è®¾ç½®ä»£ç†
</code></pre>
<h2 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h2>
<h3 id="æŸ¥çœ‹çŠ¶æ€">æŸ¥çœ‹çŠ¶æ€</h3>
<p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥</p>
<pre><code>python dropbox.py filestatus
</code></pre>
<p>å¯æŸ¥çœ‹å½“å‰åŒæ­¥çŠ¶æ€</p>
<pre><code>.dropbox:       unwatched
cat.sql:        up to date
dropbox.py:     syncing
project:        syncing
sendmail:       syncing
Works:          syncing
ä¸ªäººæ–‡ä»¶:        syncing
</code></pre>
<h3 id="æ’é™¤ä¸éœ€è¦åŒæ­¥çš„æ–‡ä»¶æ–‡ä»¶å¤¹">æ’é™¤ä¸éœ€è¦åŒæ­¥çš„æ–‡ä»¶/æ–‡ä»¶å¤¹</h3>
<p>åœ¨Dropbox/ ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<pre><code>python dropbox.py add è¢«æ’é™¤çš„æ–‡ä»¶å
</code></pre>
<p>å³å¯å°†è¯¥æ–‡ä»¶æ’é™¤.</p>
<p>å–æ¶ˆæ’é™¤</p>
<pre><code>python dropbox.py remove è¢«æ’é™¤çš„æ–‡ä»¶å
</code></pre>
<p>åˆ™å¯ä»¥é‡æ–°åŒæ­¥è¯¥æ–‡ä»¶</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç”¨Hexoæ­å»ºä¸ªäººåšå®¢]]></title>
        <id>https://zbx1719.github.io/post/yong-hexo-da-jian-ge-ren-bo-ke</id>
        <link href="https://zbx1719.github.io/post/yong-hexo-da-jian-ge-ren-bo-ke">
        </link>
        <updated>2017-10-18T18:40:36.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ‰äº†VPS,å¯ä»¥ç”¨æ¥ç§‘å­¦ä¸Šç½‘,ä¹Ÿå¯ä»¥æ­å»ºä¸€ä¸ªåšå®¢å†™ä¸€äº›ä¸œè¥¿.æ¯”è¾ƒäº†å„ç§åšå®¢æ¡†æ¶æœ€åé€‰æ‹©äº†Hexoæ­å»ºåšå®¢.</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ‰äº†VPS,å¯ä»¥ç”¨æ¥ç§‘å­¦ä¸Šç½‘,ä¹Ÿå¯ä»¥æ­å»ºä¸€ä¸ªåšå®¢å†™ä¸€äº›ä¸œè¥¿.æ¯”è¾ƒäº†å„ç§åšå®¢æ¡†æ¶æœ€åé€‰æ‹©äº†Hexoæ­å»ºåšå®¢.</p>
<!-- more -->
<h2 id="å‡†å¤‡">å‡†å¤‡</h2>
<ul>
<li>
<p>VPS</p>
<pre><code>  ç³»ç»Ÿä¸é™,æˆ‘é‡‡ç”¨çš„æ˜¯Ubuntu 17.0.4
</code></pre>
</li>
<li>
<p>åŸŸå</p>
<pre><code>  éšä¾¿ä¸€ä¸ªåŸŸåéƒ½è¡Œ,æ²¡ä»€ä¹ˆç¡¬æ€§è¦æ±‚
</code></pre>
</li>
</ul>
<h2 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</h2>
<h3 id="å®‰è£…nodejs">å®‰è£…node.js</h3>
<p>Hexoä¾èµ–node.jsç¯å¢ƒ,å› æ­¤æˆ‘ä»¬éœ€è¦å…ˆé…ç½®å¥½node.js.
åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥</p>
<pre><code>    sudo apt-get update
    sudo apt-get install -y python-software-properties software-properties-common  
    sudo  add-apt-repository ppa:chris-lea/node.js  
    sudo apt-get update  
    sudo apt-get install nodejs 
    sudo apt install nodejs-legacy
</code></pre>
<p>å®Œæˆå®‰è£…</p>
<h3 id="å®‰è£…git">å®‰è£…Git</h3>
<p>åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥</p>
<pre><code>sudo apt-get install git
</code></pre>
<p>è¿›è¡Œå®‰è£…</p>
<h2 id="æ­å»ºhexo">æ­å»ºHexo</h2>
<h4 id="å®‰è£…">å®‰è£…</h4>
<p>å‘½ä»¤è¡Œä¸‹è¾“å…¥</p>
<pre><code>npm install -g hexo-cli
</code></pre>
<p>å®‰è£… Hexo å®Œæˆåï¼Œæ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼ŒHexo å°†ä¼šåœ¨æŒ‡å®šæ–‡ä»¶å¤¹ä¸­æ–°å»ºæ‰€éœ€è¦çš„æ–‡ä»¶ã€‚</p>
<pre><code>$ hexo init &lt;folder&gt;
$ cd &lt;folder&gt;
$ npm install
</code></pre>
<p>æ–°å»ºå®Œæˆåï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹çš„ç›®å½•å¦‚ä¸‹ï¼š</p>
<pre><code>.
â”œâ”€â”€ _config.yml
â”œâ”€â”€ package.json
â”œâ”€â”€ scaffolds
â”œâ”€â”€ source
|   â”œâ”€â”€ _drafts
|   â””â”€â”€ _posts
â””â”€â”€ themes    
</code></pre>
<p>åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥</p>
<pre><code>hexo server
</code></pre>
<p>ç„¶åç™»å½•http://127.0.0.1:4000 å³å¯æŸ¥çœ‹æ•ˆæœ
<img src="https://zbx1719.github.io/post-images/1558853479160.jpeg" alt=""></p>
<h2 id="hexoçš„ä½¿ç”¨">Hexoçš„ä½¿ç”¨</h2>
<h4 id="æ–°å»ºä¸€ç¯‡æ–‡ç« ">æ–°å»ºä¸€ç¯‡æ–‡ç« </h4>
<p>åœ¨åˆ›å»ºçš„hexoæ ¹ç›®å½•ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<pre><code>hexo new &quot;new page&quot;
</code></pre>
<p>å³å¯åœ¨ source/_posts ç›®å½•ä¸‹åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç«  new_page.md
é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€,å¯ä¿®æ”¹æ·»åŠ ä»¥ä¸‹çš„é…ç½®</p>
<pre><code>---
title: ç”¨Hexoæ­å»ºä¸ªäººåšå®¢ #æ–‡ç« æ ‡é¢˜
date: 2017-10-19 02:40:36 #æ–‡ç« ç”Ÿæˆæ—¶é—´
categories: æœåŠ¡å™¨ #æ–‡ç« çš„åˆ†ç±»,å¯å¿½ç•¥
tags: #æ–‡ç« æ ‡ç­¾,å¯å¿½ç•¥
- Hexo
- Linux
description:#ä½ å¯¹æœ¬é¡µçš„æè¿°,å¯å¿½ç•¥
---
</code></pre>
<p>å†™æ–‡ç« éœ€è¦ä½¿ç”¨markdownè¯­æ³•,å¦‚æœä¸çŸ¥é“markdownè¯­æ³•æ˜¯ä»€ä¹ˆå¯ä»¥å‚è€ƒ<a href="https://sspai.com/25137/">è¿™é‡Œ</a></p>
<h4 id="æ›´æ¢ä¸»é¢˜">æ›´æ¢ä¸»é¢˜</h4>
<p>ä»¥nextä¸»é¢˜ä¸ºä¾‹åœ¨hexoçš„ç›®å½•ä¸‹è¾“å…¥</p>
<pre><code>git clone --branch v5.1.2 https://github.com/iissnan/hexo-theme-next themes/next
</code></pre>
<p>ç„¶åæ‰“å¼€_config.ymlæ–‡ä»¶,ä¿®æ”¹themeå­—æ®µ.
æ›´å¤šä¸»é¢˜åŠé…ç½®å‚è€ƒ<a href="https://hexo.io/themes/">è¿™é‡Œ</a></p>
]]></content>
    </entry>
</feed>